<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chatroom</title>
  <style>
    /* Basic styling */
    #chatroom { max-width: 500px; margin: 20px auto; }
    #messages { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: auto; }
    .message { margin: 5px 0; }
    .timestamp { font-size: 0.8em; color: gray; }
  </style>
  <!-- Firebase Libraries -->
  <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.16.0/firebase-database.js"></script>
  <script>
    // Your Firebase configuration// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDIM86NDWhYpIURnPL3JHUy8TGAZktEaCA",
  authDomain: "chatroom-db6e8.firebaseapp.com",
  databaseURL: "https://chatroom-db6e8-default-rtdb.firebaseio.com",
  projectId: "chatroom-db6e8",
  storageBucket: "chatroom-db6e8.firebasestorage.app",
  messagingSenderId: "937054391178",
  appId: "1:937054391178:web:01d5fda8ffe6eeb5735673",
  measurementId: "G-8NJK979RS1"
};
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body>

<div id="chatroom">
  <div id="messages"></div>
  <input type="text" id="messageInput" placeholder="Type a message...">
  <button onclick="sendMessage()">Send</button>
</div>

<script>
  const db = firebase.database();
  let userName = sessionStorage.getItem("userName") || "Anonymous";

  firebase.auth().signInAnonymously()
    .catch(error => console.error("Error with authentication:", error));

  function sendMessage() {
    const message = document.getElementById("messageInput").value;
    if (message.trim()) {
      const timestamp = new Date().toLocaleTimeString();
      db.ref("messages").push({
        user: userName,
        text: message,
        time: timestamp
      });
      document.getElementById("messageInput").value = '';
    }
  }

  db.ref("messages").on("child_added", snapshot => {
    const msg = snapshot.val();
    const msgDiv = document.createElement("div");
    msgDiv.classList.add("message");
    msgDiv.innerHTML = `<strong>${msg.user}</strong>: ${msg.text} <span class="timestamp">(${msg.time})</span>`;
    document.getElementById("messages").appendChild(msgDiv);
    document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
  });
</script>

</body>
</html>
